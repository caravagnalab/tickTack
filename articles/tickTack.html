<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>tickTack • tickTack</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="tickTack">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tickTack</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/tickTack.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>tickTack</h1>
            
      

      <div class="d-none name"><code>tickTack.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>tickTack requires in input a CNAqc object with attributes cna,
mutations and metadata. The main input for the tool are: * the read
counts from somatic mutations such as single-nucleotide variants (SNVs)
in the mutation attribute; * allele-specific copy number segments (CNAs)
for clonal segments must be encoded in the cna attribute; * a tumor
purity estimate in the metadata.</p>
<p>The tool uses chromosome coordinates to map mutations to segments.
The conversion of relative to absolute genome coordinates requires to
fix a reference genome build; supported reference is GRCh38/hg17 that is
also supported in CNAqc.</p>
<p>tickTack can be used to time the genomic segmnents affected by a Copy
Number event, identifying the main clocks at which the event can be
associated.</p>
</div>
<div class="section level2">
<h2 id="the-model">The model<a class="anchor" aria-label="anchor" href="#the-model"></a>
</h2>
<p>The following concepts are used to infer copy number timing.</p>
<div class="section level3">
<h3 id="vaf-peaks">VAF peaks<a class="anchor" aria-label="anchor" href="#vaf-peaks"></a>
</h3>
<p>The point mutations that are present on the duplicated region are
duplicated in copy with the segment. Therefore we can use the proportion
of mutations happede before and after the Copy Number event
distinguishing between mutations in single copy and double copies.</p>
<p><img src="timing_problem.png" alt="Overview timing problem" width="650"><br></p>
<p>Therefore, for a single segment the value of the clock associated
with the Copy Number event is obtained as a transformation from the
proportions of mutations in single and double copy. The following
quantities need to be considered:</p>
<p><img src="Mutations_single_double_copy_draw_process.png" alt="Overview timing problem" width="650"><br></p>
<p>In the case of a trisomy without LOH, we can consider the fact that,
before
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>,
1 chromosome will accumulate mutations that will duplicate, while the
other will accumulate mutations that will remain in single copy. On the
other hand, after
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>,
both chromosomes will accumulate mutations which will remain in single
copy. Therefore one can write the system:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><msub><mi>N</mi><mn>2</mn></msub><mo>=</mo><mi>ρ</mi><mi>τ</mi><msub><mi>N</mi><mn>1</mn></msub><mo>=</mo><mi>ρ</mi><mi>τ</mi><mo>+</mo><mn>3</mn><mi>ρ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>τ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
    \begin{cases}
        N_2 = \rho \tau  
        N_1 = \rho \tau + 3\rho(1 - \tau) \nonumber % Use \nonumber to prevent numbering for a specific line
    \end{cases}
\end{align}</annotation></semantics></math></p>
<p>Using the first one to obtain
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
and inserting into the second one, the solution for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>
becomes:</p>
<p><span class="math display">$$\begin{equation}
    N_1 = N_2 + \frac{3N_2}{\tau}(1-\tau) \hspace{2mm} \rightarrow
\hspace{2mm} N_1 + 2N_2 = \frac{3N_2}{\tau} \hspace{2mm} \rightarrow
\hspace{2mm} \tau = \frac{3N_2}{N_1 + 2N_2}
\end{equation}$$</span></p>
<p>The case of the CNLOH and of the segment doubling can be treated
together. In fact, in the first case, before
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>
the mutations that will duplicate accumulate on a single chromosome and
after
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>
the mutations that will remain in a single copy accumulate on two
chromosomes. The system therefore becomes:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><msub><mi>N</mi><mn>2</mn></msub><mo>=</mo><mi>ρ</mi><mi>τ</mi><msub><mi>N</mi><mn>1</mn></msub><mo>=</mo><mn>2</mn><mi>ρ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>τ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
    \begin{cases}
        N_2 = \rho \tau  
        N_1 = 2\rho(1 - \tau) \nonumber 
    \end{cases}
\end{align}</annotation></semantics></math></p>
<p>A very similar things happens in the case of the 2:2, with the only
difference that the number of chromosomes accumulating a certain type of
mutation will be double, both after and before
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>.
Hence, the system becomes:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><msub><mi>N</mi><mn>2</mn></msub><mo>=</mo><mn>2</mn><mi>ρ</mi><mi>τ</mi><msub><mi>N</mi><mn>1</mn></msub><mo>=</mo><mn>4</mn><mi>ρ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>τ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr></mtable></mrow></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{align}
    \begin{cases}
        N_2 = 2\rho \tau  
        N_1 = 4\rho(1 - \tau) \nonumber 
    \end{cases}
\end{align}</annotation></semantics></math></p>
<p>Therefore, the two system can be solved similarly (you can simply
drop a factor of 2 in the second case). The solution for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>
easily becomes:</p>
<p><span class="math display">$$\begin{equation}
    N_1 = \frac{2N_2(1-\tau)}{\tau} \hspace{2mm} \rightarrow
\hspace{2mm} \tau(N_1 + 2N_2) = 2N_2 \hspace{2mm} \rightarrow
\hspace{2mm} \tau = \frac{2N_2}{2N_2 + N_1}
\end{equation}$$</span></p>
</div>
<div class="section level3">
<h3 id="clonal-cnas">Clonal CNAs<a class="anchor" aria-label="anchor" href="#clonal-cnas"></a>
</h3>
<p>Consider:</p>
<ul>
<li>mutations sitting on a segment
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi><mi>A</mi><mo>:</mo><mi>n</mi><mi>B</mi></mrow><annotation encoding="application/x-tex">nA:nB</annotation></semantics></math>;</li>
<li>tumour purity
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>π</mi><annotation encoding="application/x-tex">\pi</annotation></semantics></math>;</li>
<li>a healthy diploid normal;</li>
</ul>
<p>Since the proportion of all reads from the tumour is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>π</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>n</mi><mi>A</mi></msub><mo>+</mo><msub><mi>n</mi><mi>B</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\pi(n_A+n_B)</annotation></semantics></math>,
and from the normal is
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>π</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">2(1-\pi)</annotation></semantics></math>.
Then, muations present in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>m</mi><annotation encoding="application/x-tex">m</annotation></semantics></math>
copies of the tumour genome should peak at VAF value
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>m</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>c</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac displaystyle="true"><mrow><mi>m</mi><mi>π</mi><mi>c</mi></mrow><mrow><mn>2</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>π</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>π</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>n</mi><mi>A</mi></msub><mo>+</mo><msub><mi>n</mi><mi>B</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mspace width="0.167em"></mspace><mi>.</mi></mrow><annotation encoding="application/x-tex">
v_m(c) = \dfrac{m \pi c}{
2 (1 - \pi) + \pi (n_A+n_B)
} \, .
</annotation></semantics></math></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://caravagnalab.github.io/tickTack/">tickTack</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load template data</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">tickTack</span><span class="fu">::</span><span class="va"><a href="../reference/pcawg_example.html">pcawg_example</a></span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'dplyr'</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter, lag</span></span>
<span><span class="co">#&gt; The following objects are masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     intersect, setdiff, setequal, union</span></span>
<span></span>
<span><span class="va">data_reduced</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mutations <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span> <span class="va">data</span><span class="op">$</span><span class="va">mutations</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">chr</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"chr"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, </span>
<span>                     cna <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span> <span class="va">data</span><span class="op">$</span><span class="va">cna</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">chr</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"chr"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                     metadata <span class="op">=</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>purity <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">purity</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">data_reduced</span> <span class="op">&lt;-</span> <span class="fu">tickTack</span><span class="fu">::</span><span class="fu"><a href="../reference/fit_h.html">fit_h</a></span><span class="op">(</span><span class="va">data_reduced</span>, max_attempts<span class="op">=</span><span class="fl">2</span>, INIT<span class="op">=</span><span class="cn">TRUE</span>, tolerance <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Adding segment with index <span style="color: #0000BB;">2</span> to segments included in the inference.</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Adding segment with index <span style="color: #0000BB;">3</span> to segments included in the inference.</span></span>
<span><span class="co">#&gt; [1] 4</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Adding segment with index <span style="color: #0000BB;">5</span> to segments included in the inference.</span></span>
<span><span class="co">#&gt; [1] 6</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Adding segment with index <span style="color: #0000BB;">6</span> to segments included in the inference.</span></span>
<span><span class="co">#&gt; [1] 7</span></span>
<span><span class="co">#&gt; [1] 8</span></span>
<span><span class="co">#&gt; [1] 9</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Adding segment with index <span style="color: #0000BB;">10</span> to segments included in the inference.</span></span>
<span><span class="co">#&gt; [1] 11</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Adding segment with index <span style="color: #0000BB;">11</span> to segments included in the inference.</span></span>
<span><span class="co">#&gt; [1] 12</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Adding segment with index <span style="color: #0000BB;">12</span> to segments included in the inference.</span></span>
<span><span class="co">#&gt; [1] 13</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Adding segment with index <span style="color: #0000BB;">13</span> to segments included in the inference.</span></span>
<span><span class="co">#&gt; [1] 14</span></span>
<span><span class="co">#&gt; [1] 15</span></span>
<span><span class="co">#&gt; [1] 16</span></span>
<span><span class="co">#&gt; [1] 17</span></span>
<span><span class="co">#&gt; [1] 18</span></span>
<span><span class="co">#&gt; [1] 19</span></span>
<span><span class="co">#&gt; [1] 20</span></span>
<span><span class="co">#&gt; [1] 21</span></span>
<span><span class="co">#&gt; [1] 22</span></span>
<span><span class="co">#&gt; [1] 23</span></span>
<span><span class="co">#&gt; [1] 24</span></span>
<span><span class="co">#&gt; [1] 25</span></span>
<span><span class="co">#&gt; [1] 26</span></span>
<span><span class="co">#&gt; [1] 27</span></span>
<span><span class="co">#&gt; [1] 28</span></span>
<span><span class="co">#&gt; [1] 29</span></span>
<span><span class="co">#&gt; [1] 30</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Adding segment with index <span style="color: #0000BB;">30</span> to segments included in the inference.</span></span>
<span><span class="co">#&gt; [1] 31</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Adding segment with index <span style="color: #0000BB;">31</span> to segments included in the inference.</span></span>
<span><span class="co">#&gt; [1] 32</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Adding segment with index <span style="color: #0000BB;">32</span> to segments included in the inference.</span></span>
<span><span class="co">#&gt; [1] 33</span></span>
<span><span class="co">#&gt; [1] 34</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Adding segment with index <span style="color: #0000BB;">34</span> to segments included in the inference.</span></span>
<span><span class="co">#&gt; init_taus from clustering  0.788151983127011</span></span>
<span><span class="co">#&gt; Attempt 1 of 2</span></span>
<span><span class="co">#&gt; ------------------------------------------------------------ </span></span>
<span><span class="co">#&gt; EXPERIMENTAL ALGORITHM: </span></span>
<span><span class="co">#&gt;   This procedure has not been thoroughly tested and may be unstable </span></span>
<span><span class="co">#&gt;   or buggy. The interface is subject to change. </span></span>
<span><span class="co">#&gt; ------------------------------------------------------------ </span></span>
<span><span class="co">#&gt; Gradient evaluation took 0.000979 seconds </span></span>
<span><span class="co">#&gt; 1000 transitions using 10 leapfrog steps per transition would take 9.79 seconds. </span></span>
<span><span class="co">#&gt; Adjust your expectations accordingly! </span></span>
<span><span class="co">#&gt; Begin eta adaptation. </span></span>
<span><span class="co">#&gt; Iteration:   1 / 250 [  0%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration:  50 / 250 [ 20%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration: 100 / 250 [ 40%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration: 150 / 250 [ 60%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration: 200 / 250 [ 80%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Success! Found best value [eta = 1] earlier than expected. </span></span>
<span><span class="co">#&gt; Begin stochastic gradient ascent. </span></span>
<span><span class="co">#&gt;   iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  </span></span>
<span><span class="co">#&gt;      1        -4862.225             1.000            1.000 </span></span>
<span><span class="co">#&gt;      2        -4834.955             0.503            1.000 </span></span>
<span><span class="co">#&gt;      3        -4837.841             0.335            0.006   MEDIAN ELBO CONVERGED </span></span>
<span><span class="co">#&gt; Drawing a sample of size 1000 from the approximate posterior...  </span></span>
<span><span class="co">#&gt; COMPLETED. </span></span>
<span><span class="co">#&gt; Finished in  2.5 seconds.</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [[1]]$w</span></span>
<span><span class="co">#&gt;       [,1]</span></span>
<span><span class="co">#&gt;  [1,]    1</span></span>
<span><span class="co">#&gt;  [2,]    1</span></span>
<span><span class="co">#&gt;  [3,]    1</span></span>
<span><span class="co">#&gt;  [4,]    1</span></span>
<span><span class="co">#&gt;  [5,]    1</span></span>
<span><span class="co">#&gt;  [6,]    1</span></span>
<span><span class="co">#&gt;  [7,]    1</span></span>
<span><span class="co">#&gt;  [8,]    1</span></span>
<span><span class="co">#&gt;  [9,]    1</span></span>
<span><span class="co">#&gt; [10,]    1</span></span>
<span><span class="co">#&gt; [11,]    1</span></span>
<span><span class="co">#&gt; [12,]    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$tau</span></span>
<span><span class="co">#&gt; [1] 0.788152</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$phi</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$kappa</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt; ELBO for this run: -4837.84</span></span>
<span><span class="co">#&gt; Attempt 2 of 2</span></span>
<span><span class="co">#&gt; ------------------------------------------------------------ </span></span>
<span><span class="co">#&gt; EXPERIMENTAL ALGORITHM: </span></span>
<span><span class="co">#&gt;   This procedure has not been thoroughly tested and may be unstable </span></span>
<span><span class="co">#&gt;   or buggy. The interface is subject to change. </span></span>
<span><span class="co">#&gt; ------------------------------------------------------------ </span></span>
<span><span class="co">#&gt; Gradient evaluation took 0.000986 seconds </span></span>
<span><span class="co">#&gt; 1000 transitions using 10 leapfrog steps per transition would take 9.86 seconds. </span></span>
<span><span class="co">#&gt; Adjust your expectations accordingly! </span></span>
<span><span class="co">#&gt; Begin eta adaptation. </span></span>
<span><span class="co">#&gt; Iteration:   1 / 250 [  0%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration:  50 / 250 [ 20%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration: 100 / 250 [ 40%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration: 150 / 250 [ 60%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration: 200 / 250 [ 80%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Success! Found best value [eta = 1] earlier than expected. </span></span>
<span><span class="co">#&gt; Begin stochastic gradient ascent. </span></span>
<span><span class="co">#&gt;   iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  </span></span>
<span><span class="co">#&gt;      1        -4869.330             1.000            1.000 </span></span>
<span><span class="co">#&gt;      2        -4847.017             0.502            1.000 </span></span>
<span><span class="co">#&gt;      3        -4835.718             0.336            0.005   MEDIAN ELBO CONVERGED </span></span>
<span><span class="co">#&gt; Drawing a sample of size 1000 from the approximate posterior...  </span></span>
<span><span class="co">#&gt; COMPLETED. </span></span>
<span><span class="co">#&gt; Finished in  2.7 seconds.</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [[1]]$w</span></span>
<span><span class="co">#&gt;       [,1]</span></span>
<span><span class="co">#&gt;  [1,]    1</span></span>
<span><span class="co">#&gt;  [2,]    1</span></span>
<span><span class="co">#&gt;  [3,]    1</span></span>
<span><span class="co">#&gt;  [4,]    1</span></span>
<span><span class="co">#&gt;  [5,]    1</span></span>
<span><span class="co">#&gt;  [6,]    1</span></span>
<span><span class="co">#&gt;  [7,]    1</span></span>
<span><span class="co">#&gt;  [8,]    1</span></span>
<span><span class="co">#&gt;  [9,]    1</span></span>
<span><span class="co">#&gt; [10,]    1</span></span>
<span><span class="co">#&gt; [11,]    1</span></span>
<span><span class="co">#&gt; [12,]    1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$tau</span></span>
<span><span class="co">#&gt; [1] 0.8053702</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$phi</span></span>
<span><span class="co">#&gt; [1] 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$kappa</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt; ELBO for this run: -4835.72</span></span>
<span><span class="co">#&gt; [1] "output_files /tmp/RtmpWVAHud/timing_mixed_simple-diagnostic-202411251032-1-89e17c.csv\n"</span></span>
<span><span class="co">#&gt; init_taus from clustering  0.748820925173087 init_taus from clustering  0.83884804512148</span></span>
<span><span class="co">#&gt; Attempt 1 of 2</span></span>
<span><span class="co">#&gt; ------------------------------------------------------------ </span></span>
<span><span class="co">#&gt; EXPERIMENTAL ALGORITHM: </span></span>
<span><span class="co">#&gt;   This procedure has not been thoroughly tested and may be unstable </span></span>
<span><span class="co">#&gt;   or buggy. The interface is subject to change. </span></span>
<span><span class="co">#&gt; ------------------------------------------------------------ </span></span>
<span><span class="co">#&gt; Gradient evaluation took 0.001797 seconds </span></span>
<span><span class="co">#&gt; 1000 transitions using 10 leapfrog steps per transition would take 17.97 seconds. </span></span>
<span><span class="co">#&gt; Adjust your expectations accordingly! </span></span>
<span><span class="co">#&gt; Begin eta adaptation. </span></span>
<span><span class="co">#&gt; Iteration:   1 / 250 [  0%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration:  50 / 250 [ 20%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration: 100 / 250 [ 40%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration: 150 / 250 [ 60%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration: 200 / 250 [ 80%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Success! Found best value [eta = 1] earlier than expected. </span></span>
<span><span class="co">#&gt; Begin stochastic gradient ascent. </span></span>
<span><span class="co">#&gt;   iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  </span></span>
<span><span class="co">#&gt;      1        -4879.323             1.000            1.000 </span></span>
<span><span class="co">#&gt;      2        -4861.148             0.502            1.000 </span></span>
<span><span class="co">#&gt;      3        -4850.844             0.335            0.004   MEDIAN ELBO CONVERGED </span></span>
<span><span class="co">#&gt; Drawing a sample of size 1000 from the approximate posterior...  </span></span>
<span><span class="co">#&gt; COMPLETED. </span></span>
<span><span class="co">#&gt; Finished in  12.9 seconds.</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [[1]]$w</span></span>
<span><span class="co">#&gt;               [,1]        [,2]</span></span>
<span><span class="co">#&gt;  [1,] 0.0006668310 0.999333169</span></span>
<span><span class="co">#&gt;  [2,] 0.0007957734 0.999204227</span></span>
<span><span class="co">#&gt;  [3,] 0.0310593697 0.968940630</span></span>
<span><span class="co">#&gt;  [4,] 0.6534324339 0.346567566</span></span>
<span><span class="co">#&gt;  [5,] 0.9286343089 0.071365691</span></span>
<span><span class="co">#&gt;  [6,] 0.9921591514 0.007840849</span></span>
<span><span class="co">#&gt;  [7,] 0.7229043894 0.277095611</span></span>
<span><span class="co">#&gt;  [8,] 0.3650752701 0.634924730</span></span>
<span><span class="co">#&gt;  [9,] 0.9769363238 0.023063676</span></span>
<span><span class="co">#&gt; [10,] 0.1132978135 0.886702186</span></span>
<span><span class="co">#&gt; [11,] 0.9884208434 0.011579157</span></span>
<span><span class="co">#&gt; [12,] 0.9949594727 0.005040527</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$tau</span></span>
<span><span class="co">#&gt; [1] 0.7488209 0.8388480</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$phi</span></span>
<span><span class="co">#&gt; [1] 0.5 0.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$kappa</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt; ELBO for this run: -4850.84</span></span>
<span><span class="co">#&gt; Attempt 2 of 2</span></span>
<span><span class="co">#&gt; ------------------------------------------------------------ </span></span>
<span><span class="co">#&gt; EXPERIMENTAL ALGORITHM: </span></span>
<span><span class="co">#&gt;   This procedure has not been thoroughly tested and may be unstable </span></span>
<span><span class="co">#&gt;   or buggy. The interface is subject to change. </span></span>
<span><span class="co">#&gt; ------------------------------------------------------------ </span></span>
<span><span class="co">#&gt; Gradient evaluation took 0.00177 seconds </span></span>
<span><span class="co">#&gt; 1000 transitions using 10 leapfrog steps per transition would take 17.7 seconds. </span></span>
<span><span class="co">#&gt; Adjust your expectations accordingly! </span></span>
<span><span class="co">#&gt; Begin eta adaptation. </span></span>
<span><span class="co">#&gt; Iteration:   1 / 250 [  0%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration:  50 / 250 [ 20%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration: 100 / 250 [ 40%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration: 150 / 250 [ 60%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration: 200 / 250 [ 80%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Success! Found best value [eta = 1] earlier than expected. </span></span>
<span><span class="co">#&gt; Begin stochastic gradient ascent. </span></span>
<span><span class="co">#&gt;   iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  </span></span>
<span><span class="co">#&gt;      1        -4910.340             1.000            1.000 </span></span>
<span><span class="co">#&gt;      2        -4859.528             0.505            1.000 </span></span>
<span><span class="co">#&gt;      3        -4855.381             0.337            0.010   MEDIAN ELBO CONVERGED </span></span>
<span><span class="co">#&gt; Drawing a sample of size 1000 from the approximate posterior...  </span></span>
<span><span class="co">#&gt; COMPLETED. </span></span>
<span><span class="co">#&gt; Finished in  12.9 seconds.</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [[1]]$w</span></span>
<span><span class="co">#&gt;               [,1]        [,2]</span></span>
<span><span class="co">#&gt;  [1,] 0.0006668310 0.999333169</span></span>
<span><span class="co">#&gt;  [2,] 0.0007957734 0.999204227</span></span>
<span><span class="co">#&gt;  [3,] 0.0310593697 0.968940630</span></span>
<span><span class="co">#&gt;  [4,] 0.6534324339 0.346567566</span></span>
<span><span class="co">#&gt;  [5,] 0.9286343089 0.071365691</span></span>
<span><span class="co">#&gt;  [6,] 0.9921591514 0.007840849</span></span>
<span><span class="co">#&gt;  [7,] 0.7229043894 0.277095611</span></span>
<span><span class="co">#&gt;  [8,] 0.3650752701 0.634924730</span></span>
<span><span class="co">#&gt;  [9,] 0.9769363238 0.023063676</span></span>
<span><span class="co">#&gt; [10,] 0.1132978135 0.886702186</span></span>
<span><span class="co">#&gt; [11,] 0.9884208434 0.011579157</span></span>
<span><span class="co">#&gt; [12,] 0.9949594727 0.005040527</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$tau</span></span>
<span><span class="co">#&gt; [1] 0.8101585 0.8383171</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$phi</span></span>
<span><span class="co">#&gt; [1] 0.5 0.5</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$kappa</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt; ELBO for this run: -4855.38</span></span>
<span><span class="co">#&gt; [1] "output_files /tmp/RtmpWVAHud/timing_mixed_simple-diagnostic-202411251032-1-07c402.csv\n"</span></span>
<span><span class="co">#&gt; init_taus from clustering  0.847724890154379 init_taus from clustering  0.737090871364337 init_taus from clustering  0.790160541098041</span></span>
<span><span class="co">#&gt; Attempt 1 of 2</span></span>
<span><span class="co">#&gt; ------------------------------------------------------------ </span></span>
<span><span class="co">#&gt; EXPERIMENTAL ALGORITHM: </span></span>
<span><span class="co">#&gt;   This procedure has not been thoroughly tested and may be unstable </span></span>
<span><span class="co">#&gt;   or buggy. The interface is subject to change. </span></span>
<span><span class="co">#&gt; ------------------------------------------------------------ </span></span>
<span><span class="co">#&gt; Gradient evaluation took 0.002617 seconds </span></span>
<span><span class="co">#&gt; 1000 transitions using 10 leapfrog steps per transition would take 26.17 seconds. </span></span>
<span><span class="co">#&gt; Adjust your expectations accordingly! </span></span>
<span><span class="co">#&gt; Begin eta adaptation. </span></span>
<span><span class="co">#&gt; Iteration:   1 / 250 [  0%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration:  50 / 250 [ 20%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration: 100 / 250 [ 40%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration: 150 / 250 [ 60%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration: 200 / 250 [ 80%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Success! Found best value [eta = 1] earlier than expected. </span></span>
<span><span class="co">#&gt; Begin stochastic gradient ascent. </span></span>
<span><span class="co">#&gt;   iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  </span></span>
<span><span class="co">#&gt;      1        -4889.540             1.000            1.000 </span></span>
<span><span class="co">#&gt;      2        -4872.928             0.502            1.000 </span></span>
<span><span class="co">#&gt;      3        -4867.621             0.335            0.003   MEDIAN ELBO CONVERGED </span></span>
<span><span class="co">#&gt; Drawing a sample of size 1000 from the approximate posterior...  </span></span>
<span><span class="co">#&gt; COMPLETED. </span></span>
<span><span class="co">#&gt; Finished in  11.6 seconds.</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [[1]]$w</span></span>
<span><span class="co">#&gt;              [,1]        [,2]         [,3]</span></span>
<span><span class="co">#&gt;  [1,] 0.936531356 0.011447948 0.0520206962</span></span>
<span><span class="co">#&gt;  [2,] 0.980519868 0.003841245 0.0156388872</span></span>
<span><span class="co">#&gt;  [3,] 0.676067624 0.044301169 0.2796312068</span></span>
<span><span class="co">#&gt;  [4,] 0.003193491 0.004762000 0.9920445091</span></span>
<span><span class="co">#&gt;  [5,] 0.026118067 0.893275963 0.0806059707</span></span>
<span><span class="co">#&gt;  [6,] 0.031943043 0.737289696 0.2307672601</span></span>
<span><span class="co">#&gt;  [7,] 0.011226787 0.021819873 0.9669533400</span></span>
<span><span class="co">#&gt;  [8,] 0.040147886 0.023107730 0.9367443835</span></span>
<span><span class="co">#&gt;  [9,] 0.001662723 0.991994774 0.0063425029</span></span>
<span><span class="co">#&gt; [10,] 0.801481982 0.059056552 0.1394614653</span></span>
<span><span class="co">#&gt; [11,] 0.000160689 0.999470940 0.0003683708</span></span>
<span><span class="co">#&gt; [12,] 0.028163652 0.778284368 0.1935519793</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$tau</span></span>
<span><span class="co">#&gt; [1] 0.8477249 0.7370909 0.7901605</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$phi</span></span>
<span><span class="co">#&gt; [1] 0.3333333 0.3333333 0.3333333</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$kappa</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt; ELBO for this run: -4867.62</span></span>
<span><span class="co">#&gt; Attempt 2 of 2</span></span>
<span><span class="co">#&gt; ------------------------------------------------------------ </span></span>
<span><span class="co">#&gt; EXPERIMENTAL ALGORITHM: </span></span>
<span><span class="co">#&gt;   This procedure has not been thoroughly tested and may be unstable </span></span>
<span><span class="co">#&gt;   or buggy. The interface is subject to change. </span></span>
<span><span class="co">#&gt; ------------------------------------------------------------ </span></span>
<span><span class="co">#&gt; Gradient evaluation took 0.002639 seconds </span></span>
<span><span class="co">#&gt; 1000 transitions using 10 leapfrog steps per transition would take 26.39 seconds. </span></span>
<span><span class="co">#&gt; Adjust your expectations accordingly! </span></span>
<span><span class="co">#&gt; Begin eta adaptation. </span></span>
<span><span class="co">#&gt; Iteration:   1 / 250 [  0%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration:  50 / 250 [ 20%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration: 100 / 250 [ 40%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration: 150 / 250 [ 60%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration: 200 / 250 [ 80%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Success! Found best value [eta = 1] earlier than expected. </span></span>
<span><span class="co">#&gt; Begin stochastic gradient ascent. </span></span>
<span><span class="co">#&gt;   iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  </span></span>
<span><span class="co">#&gt;      1        -4902.072             1.000            1.000 </span></span>
<span><span class="co">#&gt;      2        -4879.205             0.502            1.000 </span></span>
<span><span class="co">#&gt;      3        -4864.700             0.336            0.005   MEDIAN ELBO CONVERGED </span></span>
<span><span class="co">#&gt; Drawing a sample of size 1000 from the approximate posterior...  </span></span>
<span><span class="co">#&gt; COMPLETED. </span></span>
<span><span class="co">#&gt; Finished in  11.8 seconds.</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [[1]]$w</span></span>
<span><span class="co">#&gt;              [,1]        [,2]         [,3]</span></span>
<span><span class="co">#&gt;  [1,] 0.936531356 0.011447948 0.0520206962</span></span>
<span><span class="co">#&gt;  [2,] 0.980519868 0.003841245 0.0156388872</span></span>
<span><span class="co">#&gt;  [3,] 0.676067624 0.044301169 0.2796312068</span></span>
<span><span class="co">#&gt;  [4,] 0.003193491 0.004762000 0.9920445091</span></span>
<span><span class="co">#&gt;  [5,] 0.026118067 0.893275963 0.0806059707</span></span>
<span><span class="co">#&gt;  [6,] 0.031943043 0.737289696 0.2307672601</span></span>
<span><span class="co">#&gt;  [7,] 0.011226787 0.021819873 0.9669533400</span></span>
<span><span class="co">#&gt;  [8,] 0.040147886 0.023107730 0.9367443835</span></span>
<span><span class="co">#&gt;  [9,] 0.001662723 0.991994774 0.0063425029</span></span>
<span><span class="co">#&gt; [10,] 0.801481982 0.059056552 0.1394614653</span></span>
<span><span class="co">#&gt; [11,] 0.000160689 0.999470940 0.0003683708</span></span>
<span><span class="co">#&gt; [12,] 0.028163652 0.778284368 0.1935519793</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$tau</span></span>
<span><span class="co">#&gt; [1] 0.7378740 0.7268427 0.5307254</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$phi</span></span>
<span><span class="co">#&gt; [1] 0.3333333 0.3333333 0.3333333</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$kappa</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt; ELBO for this run: -4864.7</span></span>
<span><span class="co">#&gt; [1] "output_files /tmp/RtmpWVAHud/timing_mixed_simple-diagnostic-202411251033-1-380ec8.csv\n"</span></span>
<span><span class="co">#&gt; init_taus from clustering  0.736054558698923 init_taus from clustering  0.888742403615967 init_taus from clustering  0.787255814738399 init_taus from clustering  0.834448909922351</span></span>
<span><span class="co">#&gt; Attempt 1 of 2</span></span>
<span><span class="co">#&gt; ------------------------------------------------------------ </span></span>
<span><span class="co">#&gt; EXPERIMENTAL ALGORITHM: </span></span>
<span><span class="co">#&gt;   This procedure has not been thoroughly tested and may be unstable </span></span>
<span><span class="co">#&gt;   or buggy. The interface is subject to change. </span></span>
<span><span class="co">#&gt; ------------------------------------------------------------ </span></span>
<span><span class="co">#&gt; Gradient evaluation took 0.003268 seconds </span></span>
<span><span class="co">#&gt; 1000 transitions using 10 leapfrog steps per transition would take 32.68 seconds. </span></span>
<span><span class="co">#&gt; Adjust your expectations accordingly! </span></span>
<span><span class="co">#&gt; Begin eta adaptation. </span></span>
<span><span class="co">#&gt; Iteration:   1 / 250 [  0%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration:  50 / 250 [ 20%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration: 100 / 250 [ 40%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration: 150 / 250 [ 60%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration: 200 / 250 [ 80%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Success! Found best value [eta = 1] earlier than expected. </span></span>
<span><span class="co">#&gt; Begin stochastic gradient ascent. </span></span>
<span><span class="co">#&gt;   iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  </span></span>
<span><span class="co">#&gt;      1        -4919.035             1.000            1.000 </span></span>
<span><span class="co">#&gt;      2        -4896.829             0.502            1.000 </span></span>
<span><span class="co">#&gt;      3        -4887.273             0.335            0.005   MEDIAN ELBO CONVERGED </span></span>
<span><span class="co">#&gt; Drawing a sample of size 1000 from the approximate posterior...  </span></span>
<span><span class="co">#&gt; COMPLETED. </span></span>
<span><span class="co">#&gt; Finished in  15.0 seconds.</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [[1]]$w</span></span>
<span><span class="co">#&gt;               [,1]         [,2]         [,3]         [,4]</span></span>
<span><span class="co">#&gt;  [1,] 0.0006211711 0.0020554103 0.0022571680 0.9950662507</span></span>
<span><span class="co">#&gt;  [2,] 0.0041558367 0.0200454818 0.0154845315 0.9603141500</span></span>
<span><span class="co">#&gt;  [3,] 0.0099690800 0.0195195849 0.0545812304 0.9159301047</span></span>
<span><span class="co">#&gt;  [4,] 0.0001971846 0.0001239884 0.9994689917 0.0002098352</span></span>
<span><span class="co">#&gt;  [5,] 0.8792246698 0.0137477419 0.0781551655 0.0288724227</span></span>
<span><span class="co">#&gt;  [6,] 0.6645283031 0.0153231363 0.2764039773 0.0437445833</span></span>
<span><span class="co">#&gt;  [7,] 0.0072223836 0.0015249220 0.9851040005 0.0061486939</span></span>
<span><span class="co">#&gt;  [8,] 0.0333383305 0.0173805013 0.8344083729 0.1148727954</span></span>
<span><span class="co">#&gt;  [9,] 0.9938463141 0.0006092254 0.0042482281 0.0012962324</span></span>
<span><span class="co">#&gt; [10,] 0.0001010394 0.9996880954 0.0001024007 0.0001084646</span></span>
<span><span class="co">#&gt; [11,] 0.9976909001 0.0002570023 0.0015686781 0.0004834195</span></span>
<span><span class="co">#&gt; [12,] 0.7114988397 0.0139449641 0.2353237231 0.0392324730</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$tau</span></span>
<span><span class="co">#&gt; [1] 0.7360546 0.8800000 0.7872558 0.8344489</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$phi</span></span>
<span><span class="co">#&gt; [1] 0.25 0.25 0.25 0.25</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$kappa</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt; ELBO for this run: -4887.27</span></span>
<span><span class="co">#&gt; Attempt 2 of 2</span></span>
<span><span class="co">#&gt; ------------------------------------------------------------ </span></span>
<span><span class="co">#&gt; EXPERIMENTAL ALGORITHM: </span></span>
<span><span class="co">#&gt;   This procedure has not been thoroughly tested and may be unstable </span></span>
<span><span class="co">#&gt;   or buggy. The interface is subject to change. </span></span>
<span><span class="co">#&gt; ------------------------------------------------------------ </span></span>
<span><span class="co">#&gt; Gradient evaluation took 0.003323 seconds </span></span>
<span><span class="co">#&gt; 1000 transitions using 10 leapfrog steps per transition would take 33.23 seconds. </span></span>
<span><span class="co">#&gt; Adjust your expectations accordingly! </span></span>
<span><span class="co">#&gt; Begin eta adaptation. </span></span>
<span><span class="co">#&gt; Iteration:   1 / 250 [  0%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration:  50 / 250 [ 20%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration: 100 / 250 [ 40%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration: 150 / 250 [ 60%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration: 200 / 250 [ 80%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Success! Found best value [eta = 1] earlier than expected. </span></span>
<span><span class="co">#&gt; Begin stochastic gradient ascent. </span></span>
<span><span class="co">#&gt;   iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  </span></span>
<span><span class="co">#&gt;      1        -4958.237             1.000            1.000 </span></span>
<span><span class="co">#&gt;      2        -4935.171             0.502            1.000 </span></span>
<span><span class="co">#&gt;      3        -4900.929             0.337            0.007   MEDIAN ELBO CONVERGED </span></span>
<span><span class="co">#&gt; Drawing a sample of size 1000 from the approximate posterior...  </span></span>
<span><span class="co">#&gt; COMPLETED. </span></span>
<span><span class="co">#&gt; Finished in  15.1 seconds.</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [[1]]$w</span></span>
<span><span class="co">#&gt;               [,1]         [,2]         [,3]         [,4]</span></span>
<span><span class="co">#&gt;  [1,] 0.0006211711 0.0020554103 0.0022571680 0.9950662507</span></span>
<span><span class="co">#&gt;  [2,] 0.0041558367 0.0200454818 0.0154845315 0.9603141500</span></span>
<span><span class="co">#&gt;  [3,] 0.0099690800 0.0195195849 0.0545812304 0.9159301047</span></span>
<span><span class="co">#&gt;  [4,] 0.0001971846 0.0001239884 0.9994689917 0.0002098352</span></span>
<span><span class="co">#&gt;  [5,] 0.8792246698 0.0137477419 0.0781551655 0.0288724227</span></span>
<span><span class="co">#&gt;  [6,] 0.6645283031 0.0153231363 0.2764039773 0.0437445833</span></span>
<span><span class="co">#&gt;  [7,] 0.0072223836 0.0015249220 0.9851040005 0.0061486939</span></span>
<span><span class="co">#&gt;  [8,] 0.0333383305 0.0173805013 0.8344083729 0.1148727954</span></span>
<span><span class="co">#&gt;  [9,] 0.9938463141 0.0006092254 0.0042482281 0.0012962324</span></span>
<span><span class="co">#&gt; [10,] 0.0001010394 0.9996880954 0.0001024007 0.0001084646</span></span>
<span><span class="co">#&gt; [11,] 0.9976909001 0.0002570023 0.0015686781 0.0004834195</span></span>
<span><span class="co">#&gt; [12,] 0.7114988397 0.0139449641 0.2353237231 0.0392324730</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$tau</span></span>
<span><span class="co">#&gt; [1] 0.8562327 0.8775958 0.7488825 0.8625914</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$phi</span></span>
<span><span class="co">#&gt; [1] 0.25 0.25 0.25 0.25</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$kappa</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt; ELBO for this run: -4900.93</span></span>
<span><span class="co">#&gt; [1] "output_files /tmp/RtmpWVAHud/timing_mixed_simple-diagnostic-202411251033-1-76e366.csv\n"</span></span>
<span><span class="co">#&gt; init_taus from clustering  0.727029676930893 init_taus from clustering  0.754642114738131 init_taus from clustering  0.888839383149628 init_taus from clustering  0.789260255154001 init_taus from clustering  0.834810819080032</span></span>
<span><span class="co">#&gt; Attempt 1 of 2</span></span>
<span><span class="co">#&gt; ------------------------------------------------------------ </span></span>
<span><span class="co">#&gt; EXPERIMENTAL ALGORITHM: </span></span>
<span><span class="co">#&gt;   This procedure has not been thoroughly tested and may be unstable </span></span>
<span><span class="co">#&gt;   or buggy. The interface is subject to change. </span></span>
<span><span class="co">#&gt; ------------------------------------------------------------ </span></span>
<span><span class="co">#&gt; Gradient evaluation took 0.004106 seconds </span></span>
<span><span class="co">#&gt; 1000 transitions using 10 leapfrog steps per transition would take 41.06 seconds. </span></span>
<span><span class="co">#&gt; Adjust your expectations accordingly! </span></span>
<span><span class="co">#&gt; Begin eta adaptation. </span></span>
<span><span class="co">#&gt; Iteration:   1 / 250 [  0%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration:  50 / 250 [ 20%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration: 100 / 250 [ 40%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration: 150 / 250 [ 60%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration: 200 / 250 [ 80%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Success! Found best value [eta = 1] earlier than expected. </span></span>
<span><span class="co">#&gt; Begin stochastic gradient ascent. </span></span>
<span><span class="co">#&gt;   iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  </span></span>
<span><span class="co">#&gt;      1        -4937.557             1.000            1.000 </span></span>
<span><span class="co">#&gt;      2        -4908.591             0.503            1.000 </span></span>
<span><span class="co">#&gt;      3        -4899.188             0.336            0.006   MEDIAN ELBO CONVERGED </span></span>
<span><span class="co">#&gt; Drawing a sample of size 1000 from the approximate posterior...  </span></span>
<span><span class="co">#&gt; COMPLETED. </span></span>
<span><span class="co">#&gt; Finished in  18.3 seconds.</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [[1]]$w</span></span>
<span><span class="co">#&gt;               [,1]         [,2]         [,3]         [,4]         [,5]</span></span>
<span><span class="co">#&gt;  [1,] 0.0004120960 0.0006573312 0.0014851868 0.0017660228 0.9956793632</span></span>
<span><span class="co">#&gt;  [2,] 0.0031801811 0.0054562210 0.0178843278 0.0149554365 0.9585238335</span></span>
<span><span class="co">#&gt;  [3,] 0.0086423778 0.0166373298 0.0204228407 0.0638474028 0.8904500488</span></span>
<span><span class="co">#&gt;  [4,] 0.0018380974 0.0061121834 0.0006949293 0.9885698945 0.0027848954</span></span>
<span><span class="co">#&gt;  [5,] 0.8734028140 0.0868426513 0.0047300644 0.0252110011 0.0098134692</span></span>
<span><span class="co">#&gt;  [6,] 0.0026926400 0.9945285170 0.0002245926 0.0020997137 0.0004545367</span></span>
<span><span class="co">#&gt;  [7,] 0.0107768837 0.0413442326 0.0031256837 0.9319658502 0.0127873497</span></span>
<span><span class="co">#&gt;  [8,] 0.0183876254 0.0474119845 0.0124526023 0.8411272154 0.0806205724</span></span>
<span><span class="co">#&gt;  [9,] 0.9298635588 0.0573157600 0.0012460216 0.0087982654 0.0027763941</span></span>
<span><span class="co">#&gt; [10,] 0.0001000959 0.0001001621 0.9995981499 0.0001003351 0.0001012569</span></span>
<span><span class="co">#&gt; [11,] 0.6705651433 0.2867629917 0.0036093776 0.0304463281 0.0086161593</span></span>
<span><span class="co">#&gt; [12,] 0.0001144042 0.9995740729 0.0001005676 0.0001092730 0.0001016824</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$tau</span></span>
<span><span class="co">#&gt; [1] 0.7270297 0.7546421 0.8800000 0.7892603 0.8348108</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$phi</span></span>
<span><span class="co">#&gt; [1] 0.2 0.2 0.2 0.2 0.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$kappa</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt; ELBO for this run: -4899.19</span></span>
<span><span class="co">#&gt; Attempt 2 of 2</span></span>
<span><span class="co">#&gt; ------------------------------------------------------------ </span></span>
<span><span class="co">#&gt; EXPERIMENTAL ALGORITHM: </span></span>
<span><span class="co">#&gt;   This procedure has not been thoroughly tested and may be unstable </span></span>
<span><span class="co">#&gt;   or buggy. The interface is subject to change. </span></span>
<span><span class="co">#&gt; ------------------------------------------------------------ </span></span>
<span><span class="co">#&gt; Gradient evaluation took 0.004039 seconds </span></span>
<span><span class="co">#&gt; 1000 transitions using 10 leapfrog steps per transition would take 40.39 seconds. </span></span>
<span><span class="co">#&gt; Adjust your expectations accordingly! </span></span>
<span><span class="co">#&gt; Begin eta adaptation. </span></span>
<span><span class="co">#&gt; Iteration:   1 / 250 [  0%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration:  50 / 250 [ 20%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration: 100 / 250 [ 40%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration: 150 / 250 [ 60%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Iteration: 200 / 250 [ 80%]  (Adaptation) </span></span>
<span><span class="co">#&gt; Success! Found best value [eta = 1] earlier than expected. </span></span>
<span><span class="co">#&gt; Begin stochastic gradient ascent. </span></span>
<span><span class="co">#&gt;   iter             ELBO   delta_ELBO_mean   delta_ELBO_med   notes  </span></span>
<span><span class="co">#&gt;      1        -4930.180             1.000            1.000 </span></span>
<span><span class="co">#&gt;      2        -4903.911             0.503            1.000 </span></span>
<span><span class="co">#&gt;      3        -4888.623             0.336            0.005   MEDIAN ELBO CONVERGED </span></span>
<span><span class="co">#&gt; Drawing a sample of size 1000 from the approximate posterior...  </span></span>
<span><span class="co">#&gt; COMPLETED. </span></span>
<span><span class="co">#&gt; Finished in  18.4 seconds.</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [[1]]$w</span></span>
<span><span class="co">#&gt;               [,1]         [,2]         [,3]         [,4]         [,5]</span></span>
<span><span class="co">#&gt;  [1,] 0.0004120960 0.0006573312 0.0014851868 0.0017660228 0.9956793632</span></span>
<span><span class="co">#&gt;  [2,] 0.0031801811 0.0054562210 0.0178843278 0.0149554365 0.9585238335</span></span>
<span><span class="co">#&gt;  [3,] 0.0086423778 0.0166373298 0.0204228407 0.0638474028 0.8904500488</span></span>
<span><span class="co">#&gt;  [4,] 0.0018380974 0.0061121834 0.0006949293 0.9885698945 0.0027848954</span></span>
<span><span class="co">#&gt;  [5,] 0.8734028140 0.0868426513 0.0047300644 0.0252110011 0.0098134692</span></span>
<span><span class="co">#&gt;  [6,] 0.0026926400 0.9945285170 0.0002245926 0.0020997137 0.0004545367</span></span>
<span><span class="co">#&gt;  [7,] 0.0107768837 0.0413442326 0.0031256837 0.9319658502 0.0127873497</span></span>
<span><span class="co">#&gt;  [8,] 0.0183876254 0.0474119845 0.0124526023 0.8411272154 0.0806205724</span></span>
<span><span class="co">#&gt;  [9,] 0.9298635588 0.0573157600 0.0012460216 0.0087982654 0.0027763941</span></span>
<span><span class="co">#&gt; [10,] 0.0001000959 0.0001001621 0.9995981499 0.0001003351 0.0001012569</span></span>
<span><span class="co">#&gt; [11,] 0.6705651433 0.2867629917 0.0036093776 0.0304463281 0.0086161593</span></span>
<span><span class="co">#&gt; [12,] 0.0001144042 0.9995740729 0.0001005676 0.0001092730 0.0001016824</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$tau</span></span>
<span><span class="co">#&gt; [1] 0.6627133 0.6726886 0.8800000 0.8094827 0.7090720</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$phi</span></span>
<span><span class="co">#&gt; [1] 0.2 0.2 0.2 0.2 0.2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[1]]$kappa</span></span>
<span><span class="co">#&gt; [1] 5</span></span>
<span><span class="co">#&gt; ELBO for this run: -4888.62</span></span>
<span><span class="co">#&gt; [1] "output_files /tmp/RtmpWVAHud/timing_mixed_simple-diagnostic-202411251034-1-190a51.csv\n"</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="va">data_reduced</span><span class="op">$</span><span class="va">results_timing</span></span>
<span></span>
<span><span class="co"># </span></span>
<span><span class="co"># input_data &lt;- results$data$input_data</span></span>
<span><span class="co"># draws_and_summary &lt;- results$draws_and_summary</span></span>
<span><span class="co"># log_lik_matrix_list &lt;- results$log_lik_matrix_list</span></span>
<span><span class="co"># elbo_iterations &lt;- results$elbo_iterations</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># results_model_selection &lt;- model_selection_h(input_data, draws_and_summary, log_lik_matrix_list, elbo_iterations)</span></span>
<span><span class="co"># </span></span>
<span><span class="co"># best_K &lt;- results_model_selection$best_K</span></span>
<span><span class="co"># model_selection_tibble &lt;- results_model_selection$model_selection_tibble</span></span>
<span><span class="co"># entropy &lt;- results_model_selection$entropy_list</span></span>
<span></span>
<span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_inference_h.html">plot_inference_h</a></span><span class="op">(</span><span class="va">results</span>, <span class="va">data_reduced</span><span class="op">$</span><span class="va">cna</span>, <span class="va">input_data</span>, colour_by <span class="op">=</span> <span class="st">"karyotype"</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">p</span></span></code></pre></div>
<p><img src="tickTack_files/figure-html/data-1.png" width="700"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plot(1:10)</span></span>
<span><span class="co"># plot(10:1)</span></span></code></pre></div>
<p>Also a quote using <code>&gt;</code>:</p>
<blockquote>
<p>“He who gives up [code] safety for [code] speed deserves neither.”
(<a href="https://twitter.com/hadleywickham/status/504368538874703872" class="external-link">via</a>)</p>
</blockquote>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by First Last.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
