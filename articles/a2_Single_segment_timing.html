<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>2. Timing Clonal Peaks • tickTack</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="2. Timing Clonal Peaks">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tickTack</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/tickTack.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/a1_introduction.html">1. Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/a2_Single_segment_timing.html">2. Timing Clonal Peaks</a></li>
    <li><a class="dropdown-item" href="../articles/a3_Understanding_single_segment_timing.html">3. Understanding Timing of Clonal Peaks</a></li>
    <li><a class="dropdown-item" href="../articles/a4_Multiple_segment_timing.html">4. Timing Clonal Peaks in a hierarchical fashioin</a></li>
    <li><a class="dropdown-item" href="../articles/a5_Understanding_multiple_segments_timing.html">5. Understanding Timing of Multiple Clonal Peaks</a></li>
    <li><a class="dropdown-item" href="../articles/a6_Simulate_data.html">6. Simulate data</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>2. Timing Clonal Peaks</h1>
            
      

      <div class="d-none name"><code>a2_Single_segment_timing.Rmd</code></div>
    </div>

    
    
<p>The <code>fit</code> function in the <code>tickTack</code> package
estimates the timing of clonal peaks in cancer genome sequencing data.
This vignette describes the functionality of the <code>fit</code>
function, including input requirements, output, and an example analysis
using the <code><a href="../reference/pcawg_example.html">tickTack::pcawg_example</a></code> dataset.</p>
<div class="section level2">
<h2 id="overview-of-the-fit-function">Overview of the <code>fit</code> Function<a class="anchor" aria-label="anchor" href="#overview-of-the-fit-function"></a>
</h2>
<p>The <code>fit</code> function uses either a beta-binomial or binomial
model to fit clonal peaks in sequencing data. It identifies segments of
the genome with specific karyotypes and mutations that meet the input
criteria, then estimates the timing of clonal expansions.</p>
<div class="section level3">
<h3 id="key-parameters">Key Parameters<a class="anchor" aria-label="anchor" href="#key-parameters"></a>
</h3>
<ul>
<li>
<strong><code>segments</code></strong>: A data frame with segment
information, including <code>chr</code>, <code>from</code>,
<code>to</code>, <code>Major</code>, and <code>minor</code>.</li>
<li>
<strong><code>mutations</code></strong>: A data frame with mutation
data, including <code>chr</code>, <code>from</code>, <code>to</code>,
<code>DP</code>, and <code>NV</code>.</li>
<li>
<strong><code>purity</code></strong>: Tumor purity as a numeric
value.</li>
<li>
<strong><code>possible_k</code></strong>: A character vector of
possible karyotypes, defaulting to
<code>c("2:1", "2:2", "2:0")</code>.</li>
<li>
<strong><code>alpha</code></strong>: Significance level, defaulting
to <code>0.05</code>.</li>
<li>
<strong><code>min_mutations_number</code></strong>: Minimum number
of mutations required for analysis, defaulting to <code>2</code>.</li>
<li>
<strong><code>beta_binomial</code></strong>: Logical flag to use the
beta-binomial model, default is <code>FALSE</code>.</li>
<li>
<strong><code>beta_binomial_disp</code></strong>: Dispersion
parameter for the beta-binomial model, default is
<code>0.01</code>.</li>
</ul>
</div>
<div class="section level3">
<h3 id="output">Output<a class="anchor" aria-label="anchor" href="#output"></a>
</h3>
<p>The function returns a list containing:</p>
<ol style="list-style-type: decimal">
<li>
<strong><code>inference_results</code></strong>: Detailed timing
estimates for each segment.</li>
<li>
<strong><code>summarized_results</code></strong>: Summary statistics
for the estimated timing of clonal peaks.</li>
</ol>
<p>If no segments meet the criteria, the function returns
<code>NULL</code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="analyzing-ticktackpcawg_example">Analyzing <code>tickTack::pcawg_example</code><a class="anchor" aria-label="anchor" href="#analyzing-ticktackpcawg_example"></a>
</h2>
<p>We will use the <code><a href="../reference/pcawg_example.html">tickTack::pcawg_example</a></code> dataset to
demonstrate how to use the <code>fit</code> function.</p>
<div class="section level3">
<h3 id="input-data">Input Data<a class="anchor" aria-label="anchor" href="#input-data"></a>
</h3>
<p>The <code><a href="../reference/pcawg_example.html">tickTack::pcawg_example</a></code> dataset contains three
components:</p>
<ul>
<li>
<strong><code>mutations</code></strong>: Mutation data.</li>
<li>
<strong><code>cna</code></strong>: Copy number alterations
(CNA).</li>
<li>
<strong><code>metadata</code></strong>: Sample metadata, including
tumor purity.</li>
</ul>
<p>Preview the data:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://caravagnalab.github.io/tickTack/">tickTack</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View example dataset components</span></span>
<span><span class="va">mutations</span> <span class="op">&lt;-</span> <span class="fu">tickTack</span><span class="fu">::</span><span class="va"><a href="../reference/pcawg_example.html">pcawg_example</a></span><span class="op">$</span><span class="va">mutations</span></span>
<span><span class="va">cna</span> <span class="op">&lt;-</span> <span class="fu">tickTack</span><span class="fu">::</span><span class="va"><a href="../reference/pcawg_example.html">pcawg_example</a></span><span class="op">$</span><span class="va">cna</span></span>
<span><span class="va">metadata</span> <span class="op">&lt;-</span> <span class="fu">tickTack</span><span class="fu">::</span><span class="va"><a href="../reference/pcawg_example.html">pcawg_example</a></span><span class="op">$</span><span class="va">metadata</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">mutations</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    chr    from      to ref alt  DP NV       VAF</span></span>
<span><span class="co">## 1 chr1 1015594 1015594   C   C  99 16 0.1616162</span></span>
<span><span class="co">## 2 chr1 1866371 1866371   C   C 250 67 0.2680000</span></span>
<span><span class="co">## 3 chr1 1921712 1921712   C   C  62 20 0.3225806</span></span>
<span><span class="co">## 4 chr1 2049858 2049858   G   G 118 15 0.1271186</span></span>
<span><span class="co">## 5 chr1 2357842 2357842   C   C  84 12 0.1428571</span></span>
<span><span class="co">## 6 chr1 2771915 2771915   G   G  90 27 0.3000000</span></span>
<span><span class="co">##                                 sample</span></span>
<span><span class="co">## 1 00db1b95-8ca3-4cc4-bb46-6b8c8019a7c7</span></span>
<span><span class="co">## 2 00db1b95-8ca3-4cc4-bb46-6b8c8019a7c7</span></span>
<span><span class="co">## 3 00db1b95-8ca3-4cc4-bb46-6b8c8019a7c7</span></span>
<span><span class="co">## 4 00db1b95-8ca3-4cc4-bb46-6b8c8019a7c7</span></span>
<span><span class="co">## 5 00db1b95-8ca3-4cc4-bb46-6b8c8019a7c7</span></span>
<span><span class="co">## 6 00db1b95-8ca3-4cc4-bb46-6b8c8019a7c7</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">cna</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##    chr     from        to Major minor       CCF total_cn</span></span>
<span><span class="co">## 1 chr1    10001    790008     2     2 1.0000000        4</span></span>
<span><span class="co">## 2 chr1   790009  13212499     2     2 1.0000000        4</span></span>
<span><span class="co">## 3 chr1 13212500  33458785     2     2 1.0000000        4</span></span>
<span><span class="co">## 4 chr1 33458786  33564126     2     2 0.1943769        4</span></span>
<span><span class="co">## 5 chr1 33564127  56834601     2     2 1.0000000        4</span></span>
<span><span class="co">## 6 chr1 56834602 121499999     2     2 1.0000000        4</span></span></code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">metadata</span></span></code></pre></div>
<pre><code><span><span class="co">##                                 sample purity ploidy purity_conf_mad wgd_status</span></span>
<span><span class="co">## 1 00db1b95-8ca3-4cc4-bb46-6b8c8019a7c7  0.406  4.082           0.009        wgd</span></span>
<span><span class="co">##   wgd_uncertain</span></span>
<span><span class="co">## 1         FALSE</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="running-the-fit-function">Running the <code>fit</code> function<a class="anchor" aria-label="anchor" href="#running-the-fit-function"></a>
</h3>
<p>We can run the <code>fit</code> function on the
<code><a href="../reference/pcawg_example.html">tickTack::pcawg_example</a></code> data to infer the timing of clonal
peaks</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Extract input data</span></span>
<span><span class="va">segments</span> <span class="op">&lt;-</span> <span class="fu">tickTack</span><span class="fu">::</span><span class="va"><a href="../reference/pcawg_example.html">pcawg_example</a></span><span class="op">$</span><span class="va">cna</span></span>
<span><span class="va">mutations</span> <span class="op">&lt;-</span> <span class="fu">tickTack</span><span class="fu">::</span><span class="va"><a href="../reference/pcawg_example.html">pcawg_example</a></span><span class="op">$</span><span class="va">mutations</span></span>
<span><span class="va">purity</span> <span class="op">&lt;-</span> <span class="fu">tickTack</span><span class="fu">::</span><span class="va"><a href="../reference/pcawg_example.html">pcawg_example</a></span><span class="op">$</span><span class="va">metadata</span><span class="op">$</span><span class="va">purity</span></span>
<span></span>
<span><span class="co"># Run the fit function</span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fit.html">fit</a></span><span class="op">(</span></span>
<span>  segments <span class="op">=</span> <span class="va">segments</span>,</span>
<span>  mutations <span class="op">=</span> <span class="va">mutations</span>,</span>
<span>  purity <span class="op">=</span> <span class="va">purity</span>,</span>
<span>  possible_k <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2:1"</span>, <span class="st">"2:2"</span>, <span class="st">"2:0"</span><span class="op">)</span>,</span>
<span>  beta_binomial <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="results">Results<a class="anchor" aria-label="anchor" href="#results"></a>
</h3>
<p>The <code>results</code> object contains two components:
<code>inference_results</code> and <code>summarized_results</code>. We
can inspect these to understand the timing of clonal peaks:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># View summarized results</span></span>
<span><span class="va">results</span><span class="op">$</span><span class="va">summarized_results</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 72 × 7</span></span></span>
<span><span class="co">##    tau_low tau_mean tau_high segment karyotype chr   segment_id              </span></span>
<span><span class="co">##      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                   </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span>   0.809    0.890    0.953       2 2:2       chr1  chr1_790009_13212499    </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span>   0.844    0.912    0.962       3 2:2       chr1  chr1_13212500_33458785  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span>   0.820    0.889    0.943       5 2:2       chr1  chr1_33564127_56834601  </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span>   0.863    0.902    0.935       6 2:2       chr1  chr1_56834602_121499999 </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span>   0.399    0.683    0.891      10 2:2       chr1  chr1_143277461_149255831</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span>   0.806    0.865    0.914      11 2:2       chr1  chr1_149255832_196892499</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span>   0.809    0.863    0.909      12 2:2       chr1  chr1_196892500_247247500</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span>   0.537    0.791    0.947      13 2:2       chr1  chr1_247247501_249250620</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span>   0.768    0.825    0.874      30 2:2       chr4  chr4_74473_48199999     </span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span>   0.451    0.768    0.954      31 2:2       chr4  chr4_48200000_52699999  </span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 62 more rows</span></span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># View detailed inference results</span></span>
<span><span class="va">results</span><span class="op">$</span><span class="va">inference_results</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1,152,000 × 5</span></span></span>
<span><span class="co">##      tau segment karyotype chr   segment_id          </span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               </span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> 0.918       2 2:2       chr1  chr1_790009_13212499</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> 0.869       2 2:2       chr1  chr1_790009_13212499</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> 0.869       2 2:2       chr1  chr1_790009_13212499</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> 0.887       2 2:2       chr1  chr1_790009_13212499</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> 0.912       2 2:2       chr1  chr1_790009_13212499</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> 0.878       2 2:2       chr1  chr1_790009_13212499</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> 0.935       2 2:2       chr1  chr1_790009_13212499</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> 0.920       2 2:2       chr1  chr1_790009_13212499</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> 0.854       2 2:2       chr1  chr1_790009_13212499</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> 0.832       2 2:2       chr1  chr1_790009_13212499</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 1,151,990 more rows</span></span></span></code></pre>
</div>
<div class="section level3">
<h3 id="interpreting-the-output">Interpreting the output<a class="anchor" aria-label="anchor" href="#interpreting-the-output"></a>
</h3>
<ul>
<li>
<strong><code>inference_results</code></strong>: Contains posterior
distributions of timing estimates (<code>tau</code>) for each
segment.</li>
<li>
<strong><code>summarized_results</code></strong>: Provides the mean,
lower bound, and upper bound of the timing estimates for each
segment.</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="visulizing-the-output">Visulizing the output<a class="anchor" aria-label="anchor" href="#visulizing-the-output"></a>
</h2>
<p>The results can be viewed is genome-wise perspective using the
<code><a href="../reference/plot_timing.html">tickTack::plot_timing</a></code> function</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tickTack</span><span class="fu">::</span><span class="fu"><a href="../reference/plot_timing.html">plot_timing</a></span><span class="op">(</span><span class="va">results</span>, <span class="va">segments</span>, colour_by <span class="op">=</span> <span class="st">"karyotype"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #00BB00;">✔</span> Loading <span style="color: #00BB00;">CNAqc</span>, <span style="font-style: italic;">'Copy Number Alteration quality check'</span>. Support : <span style="color: #0000BB; font-style: italic;">&lt;https://caravagn.github.io/CNAqc/&gt;</span></span></span></code></pre>
<p><img src="a2_Single_segment_timing_files/figure-html/unnamed-chunk-4-1.png" class="r-plt" alt="" width="768" style="display: block; margin: auto;"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by First Last.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
